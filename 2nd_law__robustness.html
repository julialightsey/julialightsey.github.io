<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>[th&#601;_her&#601;tik]</title>
		<link rel="shortcut icon" href="./source/image/chamomile.ico" />
		<link rel="stylesheet" type="text/css" href="./source/common.css" />
	</head>
	<body id="top">
		<table style="border-collapse: collapse; margin-top:0px; width:100%" >
			<tr>
				<td style="padding-left:25px; padding-right:25px;">
					<table class="header">
						<tr>
							<td >
								<iframe src="./header.html" style="border-collapse: collapse; width:100%; overflow:hidden; border:0; margin:0 auto; display:block;" height="325" ></iframe>
							</td>
						</tr>
					</table>
				</td>
			</tr>
		</table>
		<table style="border-collapse: collapse;  margin-bottom:0px; margin-top:-25px; width:100%" >
			<tr>
				<td style="padding-left:25px; padding-right:25px;">
					<table class="content">
						<tr>
							<td class="content">
								<iframe src="./menu__home.html" style="border-collapse: collapse; width:100%; overflow:hidden; border:0;" height="50" ></iframe>
							</td>
						</tr>
						<tr>
							<td class="content">
								<iframe src="./menu__laws_of_software_design.html" style="border-collapse: collapse; width:100%; overflow:hidden;  border:0;" height="75" ></iframe>
							</td>
						</tr>
					</table>
				</td>
			</tr>
		</table>
		<table style="border-collapse: collapse;  margin-top:0px; margin-top:-15px; width:100%" >
			<tr>
				<td style="padding-left:25px; padding-right:25px;">
					<!--  -->
					<!-- begin content table -->
					<table class="content">
						<tr>
							<td>
								<img style="float:right; padding-left:35px; width:450px;" src="./source/image/1911a1_national_match.jpg" alt="1911a1_national_match" />
								<h3>[2nd_law__robustness]</h3>
								<p class="navigation"><a href="#top">back to top...</a></p>
								<p class="content" style="text-align:center;">There is no such thing as bad data.</p>
								<p class="quote">The antifragile loves randomness and uncertainty, which also means-crucially-a love of errors, a certain class of errors. Antifragility has a singular property of allowing us to deal with the unknown, to do things without understanding the-and do them well. Nassim Nicholas Taleb, Antifragile: Things That Gain From Disorder.</p>
								<p class="quote">When you ask people, 'What's the opposite of fragile?,' they tend to say robust, resilient, adaptable, solid, strong. That's not it. The opposite of fragile is something that gains from disorder. Nassim Nicholas Taleb, Antifragile: Things That Gain From Disorder.</p>
								<p class="content">A well designed and executed program should handle both expected and unexpected data professionally and gracefully, using it, cleansing it, or reporting and rejecting it.</p>
								<p class="quote">The liar's punishment is not in the least that he is not believed, but that he cannot believe anyone else. -  George Bernard Shaw.</p>
								<p class="content">The string N&#39;abc&#39; is neither good nor bad. It may be unexpected if it is being inserted into a column defined as [col1] [int]. But it is not bad. Data is just data. Similarly, tools are not inherently bad. Upholstery hammers aren&#39;t bad, but a carpenter who attempts to use one to drive a tenpenney nail into a wall joist will be disappointed in the result. To blame the hammer for the carpenters poor judgement is both idiotic and deceitful.</p>
								<p class="quote">Steel can be any shape you want if you are skilled enough, and any shape but the one you want if you are not. Robert M. Pirsig.</p>
								<p class="content">The objective of virtually every software program ever written is and has been to manipulate data. Handling data is what a software program does! Bad data and bad tools are myths invented and promoted by bad software architects and bad developers who write bad programs using bad software development practices. Both are the bane of the incompetent.</p>
								<p class="quote">It is possible to fly without motors, but not without knowledge and skill. Wilbur Wright.</p>
								<p class="content">I don't design objects with the intent to let it fail. That actually was the methodology for a group that I worked with recently. They refused to allow any error handling in the code. Nor would they allow any 'complex' constructs, insisting on building code that could be understood by the most junior developer. It was common to be woken up at zero dark thirty when on call to debug a failure and find out it was something as simple as the inbound data (these were mostly ETL {Extract/Transform/Load} processes) having an alphanumeric where a numeric string was expected. Rather than using common data scrubbing techniques they chose to let the code fail. It should be obvious to all but the least intelligent that this is a 'house of cards'. The more processes that you implement in this manner, the more 'live' debugging you will need to do. This is not a scalable solution.</p>
								<p class="content">I commonly use data scrubbing techniques for any data that is manipulated. For an ETL process I might use a PowerShell script that parses the file using regular expressions to evaluate each column of each row, extracting the rows that pass to a 'good' file and the rows that fail to a 'bad' file. For inbound parameters I often use typed XML as a data type. This allows me to use regular expressions to type the data so that, for example, I can require that a string be only forty characters. If I simply define the input parameter as [varchar](40), a longer string will be silently truncated. Using typed XML an inbound string of more than forty characters will cause an exception, notifying the calling application that the data is invalid. Silently truncating business data is simply not something that I will consider. An application, an object, should be robust enough to handle business data safely and securely, reporting intelligent exceptions. Failure due to an unexpected condition or unusual data is never an option.
								</p>
							</td>
						</tr>
					</table>
					<table class="content">
						<tr>
							<td>
								<div><span style="font-family: Courier New; font-size: 10pt;">
									<span style="color: green; font-style: italic; ">/*
									<br/>&nbsp;&nbsp;All&nbsp;content&nbsp;is&nbsp;licensed&nbsp;as&nbsp;[chamomile]&nbsp;(http://www.KELightsey.com/license.html)&nbsp;and&nbsp;
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;copyright&nbsp;Katherine&nbsp;Elizabeth&nbsp;Lightsey,&nbsp;1959-2014&nbsp;(aka;&nbsp;my&nbsp;life),&nbsp;all&nbsp;rights&nbsp;reserved,
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;as&nbsp;open&nbsp;source&nbsp;under&nbsp;the&nbsp;GNU&nbsp;Affero&nbsp;GPL&nbsp;(http://www.gnu.org/licenses/agpl-3.0.html).
									<br/>&nbsp;&nbsp;---------------------------------------------
									<br/>
									<br/>&nbsp;&nbsp;--
									<br/>&nbsp;&nbsp;--&nbsp;&nbsp;description
									<br/>&nbsp;&nbsp;---------------------------------------------
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;[2nd_law](http://www.katherinelightsey.com/#!nobaddata/c1irw)&nbsp;
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;There&nbsp;is&nbsp;no&nbsp;such&nbsp;thing&nbsp;as&nbsp;"bad"&nbsp;data.&nbsp;A&nbsp;well&nbsp;designed&nbsp;and&nbsp;executed&nbsp;program&nbsp;should&nbsp;&nbsp;
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;handle&nbsp;both&nbsp;expected&nbsp;and&nbsp;unexpected&nbsp;data&nbsp;professionally&nbsp;and&nbsp;gracefully,&nbsp;using&nbsp;it,&nbsp;&nbsp;
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;cleansing&nbsp;it,&nbsp;or&nbsp;reporting&nbsp;and&nbsp;rejecting&nbsp;it.&nbsp;The&nbsp;string&nbsp;N'abc'&nbsp;is&nbsp;neither&nbsp;good&nbsp;nor&nbsp;&nbsp;
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;bad.&nbsp;It&nbsp;may&nbsp;be&nbsp;unexpected&nbsp;if&nbsp;it&nbsp;is&nbsp;being&nbsp;inserted&nbsp;into&nbsp;a&nbsp;column&nbsp;defined&nbsp;as&nbsp;&nbsp;
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;[col1]&nbsp;[int].&nbsp;But&nbsp;it&nbsp;is&nbsp;not&nbsp;bad.&nbsp;Data&nbsp;is&nbsp;just&nbsp;data.&nbsp;Similarly,&nbsp;tools&nbsp;are&nbsp;not&nbsp;&nbsp;
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;inherently&nbsp;bad.&nbsp;Upholstery&nbsp;hammers&nbsp;aren't&nbsp;bad,&nbsp;but&nbsp;a&nbsp;carpenter&nbsp;who&nbsp;attempts&nbsp;to&nbsp;&nbsp;
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;use&nbsp;one&nbsp;to&nbsp;drive&nbsp;a&nbsp;tenpenney&nbsp;nail&nbsp;into&nbsp;a&nbsp;wall&nbsp;joist&nbsp;will&nbsp;be&nbsp;disappointed&nbsp;in&nbsp;the&nbsp;&nbsp;
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;result.&nbsp;To&nbsp;blame&nbsp;the&nbsp;hammer&nbsp;for&nbsp;the&nbsp;carpenters&nbsp;poor&nbsp;judgement&nbsp;is&nbsp;both&nbsp;idiotic&nbsp;&nbsp;
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;deceitful.&nbsp;&nbsp;
									<br/>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;Steel&nbsp;can&nbsp;be&nbsp;any&nbsp;shape&nbsp;you&nbsp;want&nbsp;if&nbsp;you&nbsp;are&nbsp;skilled&nbsp;enough,&nbsp;and&nbsp;any&nbsp;shape&nbsp;but&nbsp;the&nbsp;one&nbsp;&nbsp;
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;you&nbsp;want&nbsp;if&nbsp;you&nbsp;are&nbsp;not.&nbsp;Robert&nbsp;M.&nbsp;Pirsig.&nbsp;
									<br/>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;objective&nbsp;of&nbsp;virtually&nbsp;every&nbsp;software&nbsp;program&nbsp;ever&nbsp;written&nbsp;is&nbsp;and&nbsp;has&nbsp;been&nbsp;to&nbsp;&nbsp;
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;manipulate&nbsp;data.&nbsp;Handling&nbsp;data&nbsp;is&nbsp;what&nbsp;a&nbsp;software&nbsp;program&nbsp;does!&nbsp;Bad&nbsp;data&nbsp;and&nbsp;bad&nbsp;&nbsp;
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;tools&nbsp;are&nbsp;myths&nbsp;invented&nbsp;and&nbsp;promoted&nbsp;by&nbsp;bad&nbsp;software&nbsp;architects&nbsp;and&nbsp;bad&nbsp;developers&nbsp;&nbsp;
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;who&nbsp;write&nbsp;bad&nbsp;programs&nbsp;using&nbsp;bad&nbsp;software&nbsp;development&nbsp;practices.&nbsp;Both&nbsp;are&nbsp;the&nbsp;bane&nbsp;&nbsp;
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;the&nbsp;incompetent.&nbsp;
									<br/>
									<br/>&nbsp;&nbsp;--
									<br/>&nbsp;&nbsp;--&nbsp;&nbsp;notes
									<br/>&nbsp;&nbsp;---------------------------------------------
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;this&nbsp;presentation&nbsp;is&nbsp;designed&nbsp;to&nbsp;be&nbsp;run&nbsp;incrementally&nbsp;a&nbsp;code&nbsp;block&nbsp;at&nbsp;a&nbsp;time.&nbsp;
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;code&nbsp;blocks&nbsp;are&nbsp;delineated&nbsp;as:
									<br/>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;--
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;code&nbsp;block&nbsp;begin
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;-----------------------------------------
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<run&nbsp;code&nbsp;here>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;-----------------------------------------
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;code&nbsp;block&nbsp;end
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;--
									<br/>&nbsp;&nbsp;
									<br/>&nbsp;&nbsp;--
									<br/>&nbsp;&nbsp;--&nbsp;references
									<br/>&nbsp;&nbsp;---------------------------------------------
									<br/>*/</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;&nbsp;code&nbsp;block&nbsp;begin</span>
									<br/><span style="color: blue; ">use</span>&nbsp;<span style="color: maroon; ">[chamomile]</span><span style="color: silver; ">;</span>
									<br/><span style="color: maroon; ">go</span>
									<br/><span style="color: blue; ">if</span>&nbsp;<span style="color: #FF0080; font-weight: bold; ">schema_id</span><span style="color: maroon; ">(</span><span style="color: red; ">N'unbreakable_code'</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">is</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: blue; ">execute</span>&nbsp;<span style="color: maroon; ">(</span><span style="color: red; ">N'create&nbsp;schema&nbsp;unbreakable_code'</span><span style="color: maroon; ">)</span><span style="color: silver; ">;</span>
									<br/><span style="color: maroon; ">go</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;&nbsp;code&nbsp;block&nbsp;end</span>
									<br/><span style="color: blue; ">use</span>&nbsp;<span style="color: maroon; ">[chamomile]</span><span style="color: silver; ">;</span>
									<br/><span style="color: maroon; ">go</span>
									<br/><span style="color: blue; ">if</span>&nbsp;<span style="color: #FF0080; font-weight: bold; ">schema_id</span><span style="color: maroon; ">(</span><span style="color: red; ">N'documentation'</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">is</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: blue; ">execute</span><span style="color: maroon; ">(</span><span style="color: red; ">N'create&nbsp;schema&nbsp;documentation'</span><span style="color: maroon; ">)</span><span style="color: silver; ">;</span>
									<br/><span style="color: maroon; ">go</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;&nbsp;</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;&nbsp;bad&nbsp;design,&nbsp;not&nbsp;bad&nbsp;data&nbsp;</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;&nbsp;a&nbsp;typical&nbsp;design&nbsp;fails&nbsp;when&nbsp;an&nbsp;attempt&nbsp;to&nbsp;insert&nbsp;"unexpected"&nbsp;data&nbsp;is&nbsp;made.&nbsp;</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&nbsp;</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&nbsp;</span>
									<br/><span style="color: blue; ">if</span>&nbsp;<span style="color: fuchsia; font-style: italic; ">object_id</span><span style="color: maroon; ">(</span><span style="color: red; ">N'[documentation].[test_without_constraints]'</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">is</span>&nbsp;<span style="color: blue; ">not</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: blue; ">drop</span>&nbsp;<span style="color: blue; ">table</span>&nbsp;<span style="color: maroon; ">[documentation]</span><span style="color: silver; ">.</span><span style="color: maroon; ">[test_without_constraints]</span><span style="color: silver; ">;</span>
									<br/><span style="color: blue; ">create</span>&nbsp;<span style="color: blue; ">table</span>&nbsp;<span style="color: maroon; ">[documentation]</span><span style="color: silver; ">.</span><span style="color: maroon; ">[test_without_constraints]</span>&nbsp;<span style="color: maroon; ">(</span>
									<br/>&nbsp;&nbsp;<span style="color: maroon; ">[id]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[int]</span>&nbsp;<span style="color: blue; ">identity</span><span style="color: maroon; ">(</span><span style="color: black; ">1</span><span style="color: silver; ">,</span>&nbsp;<span style="color: black; ">1</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">not</span>&nbsp;<span style="color: blue; ">null</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">constraint</span>&nbsp;<span style="color: maroon; ">[documentation.test_without_constraints.id.primary_key.clustered]</span>&nbsp;<span style="color: blue; ">primary</span>&nbsp;<span style="color: blue; ">key</span>&nbsp;<span style="color: blue; ">clustered</span>&nbsp;<span style="color: maroon; ">(</span><span style="color: maroon; ">[id]</span><span style="color: maroon; ">)</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[amount]</span>&nbsp;<span style="color: black; font-style: italic; ">[money]</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[status]</span>&nbsp;<span style="color: black; font-style: italic; ">[sysname]</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[due]</span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[datetime]</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[phone]</span>&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[nvarchar]</span><span style="color: maroon; ">(</span><span style="color: black; ">128</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[added]</span>&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[datetime]</span>&nbsp;<span style="color: blue; ">not</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: maroon; ">)</span><span style="color: silver; ">;</span>
									<br/><span style="color: blue; ">alter</span>&nbsp;<span style="color: blue; ">table</span>&nbsp;<span style="color: maroon; ">[documentation]</span><span style="color: silver; ">.</span><span style="color: maroon; ">[test_without_constraints]</span>
									<br/>&nbsp;&nbsp;<span style="color: blue; ">add</span>&nbsp;<span style="color: blue; ">constraint</span>&nbsp;<span style="color: maroon; ">[documentation.test_without_constraints.added.default]</span>&nbsp;<span style="color: blue; ">default</span>&nbsp;<span style="color: maroon; ">(</span><span style="color: blue; ">current_timestamp</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">for</span>&nbsp;<span style="color: maroon; ">[added]</span><span style="color: silver; ">;</span>
									<br/><span style="color: maroon; ">go</span>
									<br/><span style="color: blue; ">begin</span>&nbsp;<span style="color: maroon; ">try</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">insert</span>&nbsp;<span style="color: blue; ">into</span>&nbsp;<span style="color: maroon; ">[documentation]</span><span style="color: silver; ">.</span><span style="color: maroon; ">[test_without_constraints]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: maroon; ">[amount]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[status]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[due]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[phone]</span><span style="color: maroon; ">)</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">values</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: blue; ">null</span><span style="color: silver; ">,</span><span style="color: red; ">N'on_time'</span><span style="color: silver; ">,</span><span style="color: blue; ">null</span><span style="color: silver; ">,</span><span style="color: blue; ">null</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: red; ">N'Randy&nbsp;Johnson'</span><span style="color: silver; ">,</span><span style="color: red; ">N'on_time'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20140101'</span><span style="color: silver; ">,</span><span style="color: red; ">N'2155551212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">12</span><span style="color: silver; ">,</span><span style="color: red; ">N'on_time'</span><span style="color: silver; ">,</span><span style="color: red; ">N'tomorrow'</span><span style="color: silver; ">,</span><span style="color: red; ">N'2155551212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">30</span><span style="color: silver; ">,</span><span style="color: red; ">N'late'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20140103'</span><span style="color: silver; ">,</span><span style="color: red; ">N'2155551212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">563</span><span style="color: silver; ">,</span><span style="color: red; ">N'on_time'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20150201'</span><span style="color: silver; ">,</span><span style="color: red; ">N'(215)&nbsp;555-1212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">22</span><span style="color: silver; ">,</span><span style="color: red; ">N'coerced'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20150101'</span><span style="color: silver; ">,</span><span style="color: red; ">N'215.555.1212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">375</span><span style="color: silver; ">,</span><span style="color: red; ">N'planned'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20150201'</span><span style="color: silver; ">,</span><span style="color: red; ">N'(215)&nbsp;555-1212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">;</span>
									<br/><span style="color: blue; ">end</span>&nbsp;<span style="color: maroon; ">try</span>
									<br/><span style="color: blue; ">begin</span>&nbsp;<span style="color: maroon; ">catch</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">select</span>&nbsp;<span style="color: red; ">N'this&nbsp;fails&nbsp;due&nbsp;to&nbsp;attempts&nbsp;to&nbsp;insert&nbsp;character&nbsp;strings&nbsp;into&nbsp;the&nbsp;[money]&nbsp;field&nbsp;and&nbsp;non-date&nbsp;strings&nbsp;into&nbsp;the&nbsp;[date]&nbsp;field.'</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: #FF0080; font-weight: bold; ">error_message</span><span style="color: maroon; ">(</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">as</span>&nbsp;<span style="color: maroon; ">[error_message]</span><span style="color: silver; ">;</span>
									<br/><span style="color: blue; ">end</span>&nbsp;<span style="color: maroon; ">catch</span>
									<br/><span style="color: maroon; ">go</span>
									<br/><span style="color: green; font-style: italic; ">/*&nbsp;
									<br/>&nbsp;&nbsp;this&nbsp;method&nbsp;scrubs&nbsp;the&nbsp;data&nbsp;prior&nbsp;to&nbsp;an&nbsp;attempt&nbsp;to&nbsp;insert,&nbsp;resulting&nbsp;in&nbsp;no&nbsp;failure.&nbsp;An&nbsp;&nbsp;
									<br/>&nbsp;&nbsp;intermediary&nbsp;table&nbsp;is&nbsp;used&nbsp;as&nbsp;a&nbsp;staging&nbsp;location&nbsp;where&nbsp;a&nbsp;common&nbsp;table&nbsp;expression&nbsp;can&nbsp;&nbsp;
									<br/>&nbsp;&nbsp;extract&nbsp;the&nbsp;data,&nbsp;scrub&nbsp;it,&nbsp;and&nbsp;then&nbsp;insert&nbsp;it&nbsp;into&nbsp;the&nbsp;table.&nbsp;
									<br/>*/</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&nbsp;</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&nbsp;</span>
									<br/><span style="color: blue; ">declare</span>&nbsp;<span style="color: #8000FF; ">@builder</span>&nbsp;<span style="color: blue; ">as</span>&nbsp;<span style="color: blue; ">table</span>&nbsp;<span style="color: maroon; ">(</span>
									<br/>&nbsp;&nbsp;<span style="color: maroon; ">[amount]</span>&nbsp;&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[nvarchar]</span><span style="color: maroon; ">(</span><span style="color: black; ">128</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[status]</span>&nbsp;<span style="color: black; font-style: italic; ">[nvarchar]</span><span style="color: maroon; ">(</span><span style="color: black; ">128</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[due]</span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[nvarchar]</span><span style="color: maroon; ">(</span><span style="color: black; ">128</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[phone]</span>&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[nvarchar]</span><span style="color: maroon; ">(</span><span style="color: black; ">128</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: maroon; ">)</span><span style="color: silver; ">;</span>
									<br/><span style="color: blue; ">insert</span>&nbsp;<span style="color: blue; ">into</span>&nbsp;<span style="color: #8000FF; ">@builder</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: maroon; ">[amount]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[status]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[due]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[phone]</span><span style="color: maroon; ">)</span>
									<br/><span style="color: blue; ">values</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: blue; ">null</span><span style="color: silver; ">,</span><span style="color: red; ">N'on_time'</span><span style="color: silver; ">,</span><span style="color: blue; ">null</span><span style="color: silver; ">,</span><span style="color: blue; ">null</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">12</span><span style="color: silver; ">,</span><span style="color: red; ">N'on_time'</span><span style="color: silver; ">,</span><span style="color: red; ">N'tomorrow'</span><span style="color: silver; ">,</span><span style="color: red; ">N'2155551212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">30</span><span style="color: silver; ">,</span><span style="color: red; ">N'late'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20140103'</span><span style="color: silver; ">,</span><span style="color: red; ">N'2155551212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">563</span><span style="color: silver; ">,</span><span style="color: red; ">N'on_time'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20150201'</span><span style="color: silver; ">,</span><span style="color: red; ">N'(215)&nbsp;555-1212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">22</span><span style="color: silver; ">,</span><span style="color: red; ">N'coerced'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20150101'</span><span style="color: silver; ">,</span><span style="color: red; ">N'215.555.1212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">375</span><span style="color: silver; ">,</span><span style="color: red; ">N'planned'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20150201'</span><span style="color: silver; ">,</span><span style="color: red; ">N'(215)&nbsp;555-1212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">;</span>
									<br/><span style="color: blue; ">insert</span>&nbsp;<span style="color: blue; ">into</span>&nbsp;<span style="color: #8000FF; ">@builder</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: maroon; ">[amount]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[status]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[due]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[phone]</span><span style="color: maroon; ">)</span>
									<br/><span style="color: blue; ">values</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: blue; ">null</span><span style="color: silver; ">,</span><span style="color: red; ">N'on_time'</span><span style="color: silver; ">,</span><span style="color: blue; ">null</span><span style="color: silver; ">,</span><span style="color: blue; ">null</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: red; ">N'Randy&nbsp;Johnson'</span><span style="color: silver; ">,</span><span style="color: red; ">N'on_time'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20140101'</span><span style="color: silver; ">,</span><span style="color: red; ">N'2155551212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">;</span>
									<br/><span style="color: blue; ">with</span>&nbsp;<span style="color: maroon; ">[data_scrubber]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">as</span>&nbsp;<span style="color: maroon; ">(</span><span style="color: blue; ">select</span>&nbsp;<span style="color: maroon; ">[amount]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: blue; ">case</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">when</span>&nbsp;<span style="color: fuchsia; font-style: italic; ">lower</span><span style="color: maroon; ">(</span><span style="color: maroon; ">[status]</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">not</span>&nbsp;<span style="color: blue; ">in</span>&nbsp;<span style="color: maroon; ">(</span>&nbsp;<span style="color: red; ">N'on_time'</span><span style="color: silver; ">,</span>&nbsp;<span style="color: red; ">N'late'</span><span style="color: silver; ">,</span>&nbsp;<span style="color: red; ">N'coerced'</span>&nbsp;<span style="color: maroon; ">)</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">then</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">case</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">when</span>&nbsp;<span style="color: #FF0080; font-weight: bold; ">isnull</span><span style="color: maroon; ">(</span><span style="color: maroon; ">[due]</span><span style="color: silver; ">,</span>&nbsp;<span style="color: fuchsia; font-style: italic; ">dateadd</span><span style="color: maroon; ">(</span><span style="color: maroon; ">dd</span><span style="color: silver; ">,</span>&nbsp;<span style="color: black; ">30</span><span style="color: silver; ">,</span>&nbsp;<span style="color: blue; ">current_timestamp</span><span style="color: maroon; ">)</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: silver; ">&gt;</span>&nbsp;<span style="color: blue; ">current_timestamp</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">then</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: red; ">N'late'</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">else</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: red; ">N'on_time'</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">end</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">else</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">[status]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">end</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">as</span>&nbsp;<span style="color: maroon; ">[status]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[due]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[utility]</span><span style="color: silver; ">.</span><span style="color: #FF0080; font-weight: bold; ">[strip]</span><span style="color: maroon; ">(</span><span style="color: maroon; ">[phone]</span><span style="color: silver; ">,</span>&nbsp;<span style="color: red; ">N'0-9'</span><span style="color: silver; ">,</span>&nbsp;<span style="color: blue; ">null</span><span style="color: silver; ">,</span>&nbsp;<span style="color: blue; ">null</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">as</span>&nbsp;<span style="color: maroon; ">[phone]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">from</span>&nbsp;&nbsp;&nbsp;<span style="color: #8000FF; ">@builder</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">where</span>&nbsp;&nbsp;<span style="color: #FF0080; font-weight: bold; ">isnumeric</span><span style="color: maroon; ">(</span><span style="color: maroon; ">[amount]</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: silver; ">=</span>&nbsp;<span style="color: black; ">1</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">and</span>&nbsp;<span style="color: #FF0080; font-weight: bold; ">isdate</span><span style="color: maroon; ">(</span><span style="color: maroon; ">[due]</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: silver; ">=</span>&nbsp;<span style="color: black; ">1</span><span style="color: maroon; ">)</span>
									<br/><span style="color: blue; ">insert</span>&nbsp;<span style="color: blue; ">into</span>&nbsp;<span style="color: maroon; ">[documentation]</span><span style="color: silver; ">.</span><span style="color: maroon; ">[test_without_constraints]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: maroon; ">[amount]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[status]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[due]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[phone]</span><span style="color: maroon; ">)</span>
									<br/>&nbsp;&nbsp;<span style="color: blue; ">select</span>&nbsp;<span style="color: maroon; ">[amount]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[status]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[due]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[phone]</span>
									<br/>&nbsp;&nbsp;<span style="color: blue; ">from</span>&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">[data_scrubber]</span><span style="color: silver; ">;</span>
									<br/><span style="color: maroon; ">go</span>
									<br/><span style="color: blue; ">select</span>&nbsp;<span style="color: silver; ">*</span>
									<br/><span style="color: blue; ">from</span>&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">[documentation]</span><span style="color: silver; ">.</span><span style="color: maroon; ">[test_without_constraints]</span><span style="color: silver; ">;</span>
									<br/><span style="color: maroon; ">go</span>
									<br/><span style="color: green; font-style: italic; ">/*&nbsp;&nbsp;
									<br/>&nbsp;&nbsp;table&nbsp;constraints&nbsp;prevent&nbsp;bad&nbsp;data&nbsp;from&nbsp;loading,&nbsp;but&nbsp;still&nbsp;cause&nbsp;failures.&nbsp;table&nbsp;&nbsp;
									<br/>&nbsp;&nbsp;constraints&nbsp;are&nbsp;not&nbsp;a&nbsp;substitute&nbsp;for&nbsp;data&nbsp;scrubbing&nbsp;routines.&nbsp;
									<br/>*/</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&nbsp;</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&nbsp;</span>
									<br/><span style="color: blue; ">if</span>&nbsp;<span style="color: fuchsia; font-style: italic; ">object_id</span><span style="color: maroon; ">(</span><span style="color: red; ">N'[documentation].[test_with_constraints]'</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">is</span>&nbsp;<span style="color: blue; ">not</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: blue; ">drop</span>&nbsp;<span style="color: blue; ">table</span>&nbsp;<span style="color: maroon; ">[documentation]</span><span style="color: silver; ">.</span><span style="color: maroon; ">[test_with_constraints]</span><span style="color: silver; ">;</span>
									<br/><span style="color: blue; ">create</span>&nbsp;<span style="color: blue; ">table</span>&nbsp;<span style="color: maroon; ">[documentation]</span><span style="color: silver; ">.</span><span style="color: maroon; ">[test_with_constraints]</span>&nbsp;<span style="color: maroon; ">(</span>
									<br/>&nbsp;&nbsp;<span style="color: maroon; ">[id]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[int]</span>&nbsp;<span style="color: blue; ">identity</span><span style="color: maroon; ">(</span><span style="color: black; ">1</span><span style="color: silver; ">,</span>&nbsp;<span style="color: black; ">1</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">not</span>&nbsp;<span style="color: blue; ">null</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">constraint</span>&nbsp;<span style="color: maroon; ">[documentation.test_with_constraints.id.primary_key.clustered]</span>&nbsp;<span style="color: blue; ">primary</span>&nbsp;<span style="color: blue; ">key</span>&nbsp;<span style="color: blue; ">clustered</span>&nbsp;<span style="color: maroon; ">(</span><span style="color: maroon; ">[id]</span><span style="color: maroon; ">)</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[amount]</span>&nbsp;<span style="color: black; font-style: italic; ">[money]</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[amount_floor]</span>&nbsp;<span style="color: blue; ">as</span>&nbsp;<span style="color: blue; ">case</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">when</span>&nbsp;<span style="color: maroon; ">[amount]</span>&nbsp;<span style="color: silver; ">&lt;</span>&nbsp;<span style="color: black; ">25</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">then</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: black; ">0</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">else</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">[amount]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">end</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[status]</span>&nbsp;<span style="color: black; font-style: italic; ">[sysname]</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">constraint</span>&nbsp;<span style="color: maroon; ">[documentation.test_with_constraints.type.check]</span>&nbsp;<span style="color: blue; ">check</span>&nbsp;<span style="color: maroon; ">(</span><span style="color: fuchsia; font-style: italic; ">lower</span><span style="color: maroon; ">(</span><span style="color: maroon; ">[status]</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">in</span>&nbsp;<span style="color: maroon; ">(</span><span style="color: red; ">N'on_time'</span><span style="color: silver; ">,</span>&nbsp;<span style="color: red; ">N'late'</span><span style="color: silver; ">,</span>&nbsp;<span style="color: red; ">N'coerced'</span><span style="color: maroon; ">)</span><span style="color: maroon; ">)</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[status_test]</span>&nbsp;<span style="color: blue; ">as</span>&nbsp;<span style="color: blue; ">case</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">when</span>&nbsp;<span style="color: #FF0080; font-weight: bold; ">isnull</span><span style="color: maroon; ">(</span><span style="color: maroon; ">[due]</span><span style="color: silver; ">,</span>&nbsp;<span style="color: fuchsia; font-style: italic; ">dateadd</span><span style="color: maroon; ">(</span><span style="color: maroon; ">dd</span><span style="color: silver; ">,</span>&nbsp;<span style="color: black; ">30</span><span style="color: silver; ">,</span>&nbsp;<span style="color: blue; ">current_timestamp</span><span style="color: maroon; ">)</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: silver; ">&gt;</span>&nbsp;<span style="color: blue; ">current_timestamp</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">then</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: red; ">N'on_time'</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">else</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: red; ">N'late'</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">end</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[due]</span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[datetime]</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[phone]</span>&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[nvarchar]</span><span style="color: maroon; ">(</span><span style="color: black; ">128</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">null</span>&nbsp;<span style="color: blue; ">constraint</span>&nbsp;<span style="color: maroon; ">[documentation.test_with_constraints.phone.check]</span>&nbsp;<span style="color: blue; ">check</span>&nbsp;<span style="color: maroon; ">(</span><span style="color: #FF0080; font-weight: bold; ">isnumeric</span><span style="color: maroon; ">(</span><span style="color: #FF0080; font-weight: bold; ">isnull</span><span style="color: maroon; ">(</span><span style="color: maroon; ">[phone]</span><span style="color: silver; ">,</span>&nbsp;<span style="color: black; ">0</span><span style="color: maroon; ">)</span><span style="color: maroon; ">)</span><span style="color: silver; ">=</span><span style="color: black; ">1</span><span style="color: maroon; ">)</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[added]</span>&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[datetime]</span>&nbsp;<span style="color: blue; ">not</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: maroon; ">)</span><span style="color: silver; ">;</span>
									<br/><span style="color: blue; ">alter</span>&nbsp;<span style="color: blue; ">table</span>&nbsp;<span style="color: maroon; ">[documentation]</span><span style="color: silver; ">.</span><span style="color: maroon; ">[test_with_constraints]</span>
									<br/>&nbsp;&nbsp;<span style="color: blue; ">add</span>&nbsp;<span style="color: blue; ">constraint</span>&nbsp;<span style="color: maroon; ">[documentation.test_with_constraints.added.default]</span>&nbsp;<span style="color: blue; ">default</span>&nbsp;<span style="color: maroon; ">(</span><span style="color: blue; ">current_timestamp</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">for</span>&nbsp;<span style="color: maroon; ">[added]</span><span style="color: silver; ">;</span>
									<br/><span style="color: maroon; ">go</span>
									<br/><span style="color: blue; ">begin</span>&nbsp;<span style="color: maroon; ">try</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">insert</span>&nbsp;<span style="color: blue; ">into</span>&nbsp;<span style="color: maroon; ">[documentation]</span><span style="color: silver; ">.</span><span style="color: maroon; ">[test_with_constraints]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: maroon; ">[amount]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[status]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[due]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[phone]</span><span style="color: maroon; ">)</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">values</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: blue; ">null</span><span style="color: silver; ">,</span><span style="color: red; ">N'on_time'</span><span style="color: silver; ">,</span><span style="color: blue; ">null</span><span style="color: silver; ">,</span><span style="color: blue; ">null</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: red; ">N'Randy&nbsp;Johnson'</span><span style="color: silver; ">,</span><span style="color: red; ">N'on_time'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20140101'</span><span style="color: silver; ">,</span><span style="color: red; ">N'2155551212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">30</span><span style="color: silver; ">,</span><span style="color: red; ">N'late'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20130201'</span><span style="color: silver; ">,</span><span style="color: red; ">N'2155551212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">563</span><span style="color: silver; ">,</span><span style="color: red; ">N'late'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20150201'</span><span style="color: silver; ">,</span><span style="color: red; ">N'2155551212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">22</span><span style="color: silver; ">,</span><span style="color: red; ">N'coerced'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20150101'</span><span style="color: silver; ">,</span><span style="color: red; ">N'2155551212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">375</span><span style="color: silver; ">,</span><span style="color: red; ">N'late'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20150201'</span><span style="color: silver; ">,</span><span style="color: red; ">N'2155551212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">;</span>
									<br/><span style="color: blue; ">end</span>&nbsp;<span style="color: maroon; ">try</span>
									<br/><span style="color: blue; ">begin</span>&nbsp;<span style="color: maroon; ">catch</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">select</span>&nbsp;<span style="color: red; ">N'this&nbsp;fails&nbsp;due&nbsp;to&nbsp;attempts&nbsp;to&nbsp;insert&nbsp;character&nbsp;strings&nbsp;into&nbsp;the&nbsp;[money]&nbsp;field&nbsp;and&nbsp;non-date&nbsp;strings&nbsp;into&nbsp;the&nbsp;[date]&nbsp;field.'</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: #FF0080; font-weight: bold; ">error_message</span><span style="color: maroon; ">(</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">as</span>&nbsp;<span style="color: maroon; ">[error_message]</span><span style="color: silver; ">;</span>
									<br/><span style="color: blue; ">end</span>&nbsp;<span style="color: maroon; ">catch</span>
									<br/><span style="color: maroon; ">go</span>
									<br/><span style="color: green; font-style: italic; ">/*&nbsp;
									<br/>
									<br/>*/</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;&nbsp;</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;&nbsp;prevent&nbsp;duplicates&nbsp;using&nbsp;a&nbsp;merge&nbsp;</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&nbsp;</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&nbsp;</span>
									<br/><span style="color: blue; ">if</span>&nbsp;<span style="color: fuchsia; font-style: italic; ">object_id</span><span style="color: maroon; ">(</span><span style="color: red; ">N'[documentation].[test_without_constraints]'</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">is</span>&nbsp;<span style="color: blue; ">not</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: blue; ">drop</span>&nbsp;<span style="color: blue; ">table</span>&nbsp;<span style="color: maroon; ">[documentation]</span><span style="color: silver; ">.</span><span style="color: maroon; ">[test_without_constraints]</span><span style="color: silver; ">;</span>
									<br/><span style="color: blue; ">create</span>&nbsp;<span style="color: blue; ">table</span>&nbsp;<span style="color: maroon; ">[documentation]</span><span style="color: silver; ">.</span><span style="color: maroon; ">[test_without_constraints]</span>&nbsp;<span style="color: maroon; ">(</span>
									<br/>&nbsp;&nbsp;<span style="color: maroon; ">[id]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[int]</span>&nbsp;<span style="color: blue; ">identity</span><span style="color: maroon; ">(</span><span style="color: black; ">1</span><span style="color: silver; ">,</span>&nbsp;<span style="color: black; ">1</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">not</span>&nbsp;<span style="color: blue; ">null</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">constraint</span>&nbsp;<span style="color: maroon; ">[documentation.test_without_constraints.id.primary_key.clustered]</span>&nbsp;<span style="color: blue; ">primary</span>&nbsp;<span style="color: blue; ">key</span>&nbsp;<span style="color: blue; ">clustered</span>&nbsp;<span style="color: maroon; ">(</span><span style="color: maroon; ">[id]</span><span style="color: maroon; ">)</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[amount]</span>&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[money]</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[account]</span>&nbsp;<span style="color: black; font-style: italic; ">[bigint]</span>&nbsp;<span style="color: blue; ">not</span>&nbsp;<span style="color: blue; ">null</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">constraint</span>&nbsp;<span style="color: maroon; ">[documentation.test_without_constraints.account.unique]</span>&nbsp;<span style="color: blue; ">unique</span>&nbsp;<span style="color: maroon; ">(</span><span style="color: maroon; ">[account]</span><span style="color: maroon; ">)</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[status]</span>&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[sysname]</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[due]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[datetime]</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[phone]</span>&nbsp;&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[nvarchar]</span><span style="color: maroon; ">(</span><span style="color: black; ">128</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[added]</span>&nbsp;&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[datetime]</span>&nbsp;<span style="color: blue; ">not</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: maroon; ">)</span><span style="color: silver; ">;</span>
									<br/><span style="color: blue; ">alter</span>&nbsp;<span style="color: blue; ">table</span>&nbsp;<span style="color: maroon; ">[documentation]</span><span style="color: silver; ">.</span><span style="color: maroon; ">[test_without_constraints]</span>
									<br/>&nbsp;&nbsp;<span style="color: blue; ">add</span>&nbsp;<span style="color: blue; ">constraint</span>&nbsp;<span style="color: maroon; ">[documentation.test_without_constraints.added.default]</span>&nbsp;<span style="color: blue; ">default</span>&nbsp;<span style="color: maroon; ">(</span><span style="color: blue; ">current_timestamp</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">for</span>&nbsp;<span style="color: maroon; ">[added]</span><span style="color: silver; ">;</span>
									<br/><span style="color: maroon; ">go</span>
									<br/><span style="color: blue; ">insert</span>&nbsp;<span style="color: blue; ">into</span>&nbsp;<span style="color: maroon; ">[documentation]</span><span style="color: silver; ">.</span><span style="color: maroon; ">[test_without_constraints]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: maroon; ">[amount]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[account]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[status]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[due]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[phone]</span><span style="color: maroon; ">)</span>
									<br/><span style="color: blue; ">values</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: blue; ">null</span><span style="color: silver; ">,</span><span style="color: black; ">1</span><span style="color: silver; ">,</span><span style="color: red; ">N'on_time'</span><span style="color: silver; ">,</span><span style="color: blue; ">null</span><span style="color: silver; ">,</span><span style="color: blue; ">null</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">30</span><span style="color: silver; ">,</span><span style="color: black; ">2</span><span style="color: silver; ">,</span><span style="color: red; ">N'late'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20130201'</span><span style="color: silver; ">,</span><span style="color: red; ">N'2155551212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">563</span><span style="color: silver; ">,</span><span style="color: black; ">3</span><span style="color: silver; ">,</span><span style="color: red; ">N'late'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20150201'</span><span style="color: silver; ">,</span><span style="color: red; ">N'2155551212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">375</span><span style="color: silver; ">,</span><span style="color: black; ">4</span><span style="color: silver; ">,</span><span style="color: red; ">N'late'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20150201'</span><span style="color: silver; ">,</span><span style="color: red; ">N'2155551212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">;</span>
									<br/><span style="color: maroon; ">go</span>
									<br/><span style="color: blue; ">begin</span>&nbsp;<span style="color: maroon; ">try</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">insert</span>&nbsp;<span style="color: blue; ">into</span>&nbsp;<span style="color: maroon; ">[documentation]</span><span style="color: silver; ">.</span><span style="color: maroon; ">[test_without_constraints]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: maroon; ">[amount]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[account]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[status]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[due]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[phone]</span><span style="color: maroon; ">)</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">values</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">30</span><span style="color: silver; ">,</span><span style="color: black; ">2</span><span style="color: silver; ">,</span><span style="color: red; ">N'late'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20130201'</span><span style="color: silver; ">,</span><span style="color: red; ">N'2155551212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">30</span><span style="color: silver; ">,</span><span style="color: black; ">8</span><span style="color: silver; ">,</span><span style="color: red; ">N'late'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20130201'</span><span style="color: silver; ">,</span><span style="color: red; ">N'2155551212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">;</span>
									<br/><span style="color: blue; ">end</span>&nbsp;<span style="color: maroon; ">try</span>
									<br/><span style="color: blue; ">begin</span>&nbsp;<span style="color: maroon; ">catch</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">select</span>&nbsp;<span style="color: red; ">N'this&nbsp;fails&nbsp;due&nbsp;to&nbsp;attempts&nbsp;to&nbsp;insert&nbsp;duplicate&nbsp;data&nbsp;into&nbsp;the&nbsp;[account]&nbsp;field.'</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: #FF0080; font-weight: bold; ">error_message</span><span style="color: maroon; ">(</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">as</span>&nbsp;<span style="color: maroon; ">[error_message]</span><span style="color: silver; ">;</span>
									<br/><span style="color: blue; ">end</span>&nbsp;<span style="color: maroon; ">catch</span>
									<br/><span style="color: maroon; ">go</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;&nbsp;</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;&nbsp;using&nbsp;a&nbsp;merge&nbsp;prevents&nbsp;inserting&nbsp;duplicate&nbsp;data,&nbsp;and&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;update&nbsp;the&nbsp;data.&nbsp;</span>
									<br/><span style="color: green; font-style: italic; ">&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&nbsp;</span>
									<br/><span style="color: blue; ">declare</span>&nbsp;<span style="color: #8000FF; ">@staging</span>&nbsp;<span style="color: blue; ">as</span>&nbsp;<span style="color: blue; ">table</span>&nbsp;<span style="color: maroon; ">(</span>
									<br/>&nbsp;&nbsp;<span style="color: maroon; ">[amount]</span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[money]</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[account]</span>&nbsp;<span style="color: black; font-style: italic; ">[bigint]</span>&nbsp;<span style="color: blue; ">not</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[status]</span>&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[sysname]</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[due]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[datetime]</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[phone]</span>&nbsp;&nbsp;&nbsp;<span style="color: black; font-style: italic; ">[nvarchar]</span><span style="color: maroon; ">(</span><span style="color: black; ">128</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">null</span>
									<br/>&nbsp;&nbsp;<span style="color: maroon; ">)</span><span style="color: silver; ">;</span>
									<br/><span style="color: blue; ">insert</span>&nbsp;<span style="color: blue; ">into</span>&nbsp;<span style="color: #8000FF; ">@staging</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: maroon; ">[amount]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[account]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[status]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[due]</span><span style="color: silver; ">,</span><span style="color: maroon; ">[phone]</span><span style="color: maroon; ">)</span>
									<br/><span style="color: blue; ">values</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">30</span><span style="color: silver; ">,</span><span style="color: black; ">2</span><span style="color: silver; ">,</span><span style="color: red; ">N'late'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20130201'</span><span style="color: silver; ">,</span><span style="color: red; ">N'2155551212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">,</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">(</span><span style="color: black; ">30</span><span style="color: silver; ">,</span><span style="color: black; ">8</span><span style="color: silver; ">,</span><span style="color: red; ">N'late'</span><span style="color: silver; ">,</span><span style="color: red; ">N'20130201'</span><span style="color: silver; ">,</span><span style="color: red; ">N'2155551212'</span><span style="color: maroon; ">)</span><span style="color: silver; ">;</span>
									<br/><span style="color: blue; ">merge</span>&nbsp;<span style="color: blue; ">into</span>&nbsp;<span style="color: maroon; ">[documentation]</span><span style="color: silver; ">.</span><span style="color: maroon; ">[test_without_constraints]</span>&nbsp;<span style="color: blue; ">as</span>&nbsp;<span style="color: maroon; ">target</span>
									<br/><span style="color: maroon; ">using</span>&nbsp;<span style="color: maroon; ">(</span><span style="color: blue; ">select</span>&nbsp;<span style="color: maroon; ">[amount]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[account]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[status]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[due]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[phone]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue; ">from</span>&nbsp;&nbsp;&nbsp;<span style="color: #8000FF; ">@staging</span><span style="color: maroon; ">)</span>&nbsp;<span style="color: blue; ">as</span>&nbsp;<span style="color: maroon; ">source</span>
									<br/><span style="color: blue; ">on</span>&nbsp;<span style="color: maroon; ">source</span><span style="color: silver; ">.</span><span style="color: maroon; ">[account]</span>&nbsp;<span style="color: silver; ">=</span>&nbsp;<span style="color: maroon; ">target</span><span style="color: silver; ">.</span><span style="color: maroon; ">[account]</span>
									<br/><span style="color: blue; ">when</span>&nbsp;<span style="color: blue; ">not</span>&nbsp;<span style="color: maroon; ">matched</span>&nbsp;<span style="color: blue; ">then</span>
									<br/>&nbsp;&nbsp;<span style="color: blue; ">insert</span>&nbsp;<span style="color: maroon; ">(</span><span style="color: maroon; ">[amount]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[account]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[status]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[due]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[phone]</span><span style="color: maroon; ">)</span>
									<br/>&nbsp;&nbsp;<span style="color: blue; ">values</span>&nbsp;<span style="color: maroon; ">(</span><span style="color: maroon; ">[amount]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[account]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[status]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[due]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[phone]</span>&nbsp;<span style="color: maroon; ">)</span><span style="color: silver; ">;</span>
									<br/><span style="color: maroon; ">go</span>
									<br/><span style="color: blue; ">select</span>&nbsp;<span style="color: maroon; ">[id]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[amount]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[account]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[status]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[due]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[phone]</span>
									<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver; ">,</span>&nbsp;<span style="color: maroon; ">[added]</span>
									<br/><span style="color: blue; ">from</span>&nbsp;&nbsp;&nbsp;<span style="color: maroon; ">[documentation]</span><span style="color: silver; ">.</span><span style="color: maroon; ">[test_without_constraints]</span><span style="color: silver; ">;</span>
									<br/><span style="color: maroon; ">go</span>&nbsp;
									</span>
								</div>
							</td>
						</tr>
					</table>
				</td>
			</tr>
		</table>
		<table style="border-collapse: collapse; margin:0 auto; width:100%; margin-top:-25px;" >
			<tr>
				<td style="padding-left:25px; padding-right:25px;">
					<table class="header">
						<tr>
							<td > 
								<iframe src="./footer.html" style="border-collapse: collapse; width:100%; overflow:hidden;  border:0;" height="200" ></iframe>
							</td>
						</tr>
					</table>
				</td>
			</tr>
		</table>
	</body>
</html>